!function(e){function r(e){var r=require("./"+e+"."+o+".hot-update.js");!function(e,r){if(!x[e]||!w[e])return;for(var n in w[e]=!1,r)Object.prototype.hasOwnProperty.call(r,n)&&(h[n]=r[n]);0==--m&&0===y&&k()}(r.id,r.modules)}var n,t=!0,o="c6766680339a865c0ac6",i={},a=[],s=[];function c(e){var r=H[e];if(!r)return D;var t=function(t){return r.hot.active?(H[t]?-1===H[t].parents.indexOf(e)&&H[t].parents.push(e):(a=[e],n=t),-1===r.children.indexOf(t)&&r.children.push(t)):(console.warn("[HMR] unexpected require("+t+") from disposed module "+e),a=[]),D(t)},o=function(e){return{configurable:!0,enumerable:!0,get:function(){return D[e]},set:function(r){D[e]=r}}};for(var i in D)Object.prototype.hasOwnProperty.call(D,i)&&"e"!==i&&"t"!==i&&Object.defineProperty(t,i,o(i));return t.e=function(e){return"ready"===d&&f("prepare"),y++,D.e(e).then(r,(function(e){throw r(),e}));function r(){y--,"prepare"===d&&(b[e]||j(e),0===y&&0===m&&k())}},t.t=function(e,r){return 1&r&&(e=t(e)),D.t(e,-2&r)},t}function u(r){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:n!==r,active:!0,accept:function(e,r){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._acceptedDependencies[e[n]]=r||function(){};else t._acceptedDependencies[e]=r||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var r=0;r<e.length;r++)t._declinedDependencies[e[r]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var r=t._disposeHandlers.indexOf(e);r>=0&&t._disposeHandlers.splice(r,1)},invalidate:function(){switch(this._selfInvalidated=!0,d){case"idle":(h={})[r]=e[r],f("ready");break;case"ready":E(r);break;case"prepare":case"check":case"dispose":case"apply":(g=g||[]).push(r)}},check:O,apply:P,status:function(e){if(!e)return d;l.push(e)},addStatusHandler:function(e){l.push(e)},removeStatusHandler:function(e){var r=l.indexOf(e);r>=0&&l.splice(r,1)},data:i[r]};return n=void 0,t}var l=[],d="idle";function f(e){d=e;for(var r=0;r<l.length;r++)l[r].call(null,e)}var p,h,v,g,m=0,y=0,b={},w={},x={};function _(e){return+e+""===e?+e:e}function O(e){if("idle"!==d)throw new Error("check() is only allowed in idle status");return t=e,f("check"),function(){try{var e=require("./"+o+".hot-update.json")}catch(e){return Promise.resolve()}return Promise.resolve(e)}().then((function(e){if(!e)return f(R()?"ready":"idle"),null;w={},b={},x=e.c,v=e.h,f("prepare");var r=new Promise((function(e,r){p={resolve:e,reject:r}}));h={};return j(0),"prepare"===d&&0===y&&0===m&&k(),r}))}function j(e){x[e]?(w[e]=!0,m++,r(e)):b[e]=!0}function k(){f("ready");var e=p;if(p=null,e)if(t)Promise.resolve().then((function(){return P(t)})).then((function(r){e.resolve(r)}),(function(r){e.reject(r)}));else{var r=[];for(var n in h)Object.prototype.hasOwnProperty.call(h,n)&&r.push(_(n));e.resolve(r)}}function P(r){if("ready"!==d)throw new Error("apply() is only allowed in ready status");return function r(t){var s,c,u,l,d;function p(e){for(var r=[e],n={},t=r.map((function(e){return{chain:[e],id:e}}));t.length>0;){var o=t.pop(),i=o.id,a=o.chain;if((l=H[i])&&(!l.hot._selfAccepted||l.hot._selfInvalidated)){if(l.hot._selfDeclined)return{type:"self-declined",chain:a,moduleId:i};if(l.hot._main)return{type:"unaccepted",chain:a,moduleId:i};for(var s=0;s<l.parents.length;s++){var c=l.parents[s],u=H[c];if(u){if(u.hot._declinedDependencies[i])return{type:"declined",chain:a.concat([c]),moduleId:i,parentId:c};-1===r.indexOf(c)&&(u.hot._acceptedDependencies[i]?(n[c]||(n[c]=[]),m(n[c],[i])):(delete n[c],r.push(c),t.push({chain:a.concat([c]),id:c})))}}}}return{type:"accepted",moduleId:e,outdatedModules:r,outdatedDependencies:n}}function m(e,r){for(var n=0;n<r.length;n++){var t=r[n];-1===e.indexOf(t)&&e.push(t)}}R();var y={},b=[],w={},O=function(){console.warn("[HMR] unexpected require("+k.moduleId+") to disposed module")};for(var j in h)if(Object.prototype.hasOwnProperty.call(h,j)){var k;d=_(j),k=h[j]?p(d):{type:"disposed",moduleId:j};var P=!1,E=!1,M=!1,I="";switch(k.chain&&(I="\nUpdate propagation: "+k.chain.join(" -> ")),k.type){case"self-declined":t.onDeclined&&t.onDeclined(k),t.ignoreDeclined||(P=new Error("Aborted because of self decline: "+k.moduleId+I));break;case"declined":t.onDeclined&&t.onDeclined(k),t.ignoreDeclined||(P=new Error("Aborted because of declined dependency: "+k.moduleId+" in "+k.parentId+I));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(k),t.ignoreUnaccepted||(P=new Error("Aborted because "+d+" is not accepted"+I));break;case"accepted":t.onAccepted&&t.onAccepted(k),E=!0;break;case"disposed":t.onDisposed&&t.onDisposed(k),M=!0;break;default:throw new Error("Unexception type "+k.type)}if(P)return f("abort"),Promise.reject(P);if(E)for(d in w[d]=h[d],m(b,k.outdatedModules),k.outdatedDependencies)Object.prototype.hasOwnProperty.call(k.outdatedDependencies,d)&&(y[d]||(y[d]=[]),m(y[d],k.outdatedDependencies[d]));M&&(m(b,[k.moduleId]),w[d]=O)}var S,A=[];for(c=0;c<b.length;c++)d=b[c],H[d]&&H[d].hot._selfAccepted&&w[d]!==O&&!H[d].hot._selfInvalidated&&A.push({module:d,parents:H[d].parents.slice(),errorHandler:H[d].hot._selfAccepted});f("dispose"),Object.keys(x).forEach((function(e){!1===x[e]&&function(e){delete installedChunks[e]}(e)}));var C,q,F=b.slice();for(;F.length>0;)if(d=F.pop(),l=H[d]){var U={},N=l.hot._disposeHandlers;for(u=0;u<N.length;u++)(s=N[u])(U);for(i[d]=U,l.hot.active=!1,delete H[d],delete y[d],u=0;u<l.children.length;u++){var T=H[l.children[u]];T&&((S=T.parents.indexOf(d))>=0&&T.parents.splice(S,1))}}for(d in y)if(Object.prototype.hasOwnProperty.call(y,d)&&(l=H[d]))for(q=y[d],u=0;u<q.length;u++)C=q[u],(S=l.children.indexOf(C))>=0&&l.children.splice(S,1);f("apply"),void 0!==v&&(o=v,v=void 0);for(d in h=void 0,w)Object.prototype.hasOwnProperty.call(w,d)&&(e[d]=w[d]);var V=null;for(d in y)if(Object.prototype.hasOwnProperty.call(y,d)&&(l=H[d])){q=y[d];var L=[];for(c=0;c<q.length;c++)if(C=q[c],s=l.hot._acceptedDependencies[C]){if(-1!==L.indexOf(s))continue;L.push(s)}for(c=0;c<L.length;c++){s=L[c];try{s(q)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:d,dependencyId:q[c],error:e}),t.ignoreErrored||V||(V=e)}}}for(c=0;c<A.length;c++){var J=A[c];d=J.module,a=J.parents,n=d;try{D(d)}catch(e){if("function"==typeof J.errorHandler)try{J.errorHandler(e)}catch(r){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:d,error:r,originalError:e}),t.ignoreErrored||V||(V=r),V||(V=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:d,error:e}),t.ignoreErrored||V||(V=e)}}if(V)return f("fail"),Promise.reject(V);if(g)return r(t).then((function(e){return b.forEach((function(r){e.indexOf(r)<0&&e.push(r)})),e}));return f("idle"),new Promise((function(e){e(b)}))}(r=r||{})}function R(){if(g)return h||(h={}),g.forEach(E),g=void 0,!0}function E(r){Object.prototype.hasOwnProperty.call(h,r)||(h[r]=e[r])}var H={};function D(r){if(H[r])return H[r].exports;var n=H[r]={i:r,l:!1,exports:{},hot:u(r),parents:(s=a,a=[],s),children:[]};return e[r].call(n.exports,n,n.exports,c(r)),n.l=!0,n.exports}D.m=e,D.c=H,D.d=function(e,r,n){D.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},D.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},D.t=function(e,r){if(1&r&&(e=D(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(D.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var t in e)D.d(n,t,function(r){return e[r]}.bind(null,t));return n},D.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return D.d(r,"a",r),r},D.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},D.p="",D.h=function(){return o},c(0)(D.s=0)}({"./node_modules/webpack/hot/log-apply-result.js":function(e,r,n){e.exports=function(e,r){var t=e.filter((function(e){return r&&r.indexOf(e)<0})),o=n("./node_modules/webpack/hot/log.js");(t.length>0&&(o("warning","[HMR] The following modules couldn't be hot updated: (They would need a full reload!)"),t.forEach((function(e){o("warning","[HMR]  - "+e)}))),r&&0!==r.length)?(o("info","[HMR] Updated modules:"),r.forEach((function(e){if("string"==typeof e&&-1!==e.indexOf("!")){var r=e.split("!");o.groupCollapsed("info","[HMR]  - "+r.pop()),o("info","[HMR]  - "+e),o.groupEnd("info")}else o("info","[HMR]  - "+e)})),r.every((function(e){return"number"==typeof e}))&&o("info","[HMR] Consider using the NamedModulesPlugin for module names.")):o("info","[HMR] Nothing hot updated.")}},"./node_modules/webpack/hot/log.js":function(e,r){var n="info";function t(){}function o(e){return"info"===n&&"info"===e||["info","warning"].indexOf(n)>=0&&"warning"===e||["info","warning","error"].indexOf(n)>=0&&"error"===e}function i(e){return function(r,n){o(r)&&e(n)}}e.exports=function(e,r){o(e)&&("info"===e?console.log(r):"warning"===e?console.warn(r):"error"===e&&console.error(r))};var a=console.group||t,s=console.groupCollapsed||t,c=console.groupEnd||t;e.exports.group=i(a),e.exports.groupCollapsed=i(s),e.exports.groupEnd=i(c),e.exports.setLogLevel=function(e){n=e},e.exports.formatError=function(e){var r=e.message,n=e.stack;return n?n.indexOf(r)<0?r+"\n"+n:n:r}},"./node_modules/webpack/hot/poll.js?1000":function(e,r,n){(function(r){var t=+r.substr(1)||6e5,o=n("./node_modules/webpack/hot/log.js");setInterval((function r(t){"idle"===e.hot.status()&&e.hot.check(!0).then((function(e){e?(n("./node_modules/webpack/hot/log-apply-result.js")(e,e),r(!0)):t&&o("info","[HMR] Update applied.")})).catch((function(r){var n=e.hot.status();["abort","fail"].indexOf(n)>=0?(o("warning","[HMR] Cannot apply update."),o("warning","[HMR] "+o.formatError(r)),o("warning","[HMR] You need to restart the application!")):o("warning","[HMR] Update failed: "+o.formatError(r))}))}),t)}).call(this,"?1000")},"./src/server/OracleApp.js":function(e,r){function n(e,r,n,t,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?r(c):Promise.resolve(c).then(t,o)}function t(e){return function(){var r=this,t=arguments;return new Promise((function(o,i){var a=e.apply(r,t);function s(e){n(a,o,i,s,c,"next",e)}function c(e){n(a,o,i,s,c,"throw",e)}s(void 0)}))}}function o(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function i(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function a(e,r,n){return r&&i(e.prototype,r),n&&i(e,n),e}e.exports=function(){function e(r,n,t){o(this,e),this._numOracles=r.numOracles,this._statusCodes=r.statusCodes,this._airlineStatusCodePropability=r.airlineStatusCodeProbability,this._contract=n,this._oracles=[],this.web3=t}var r,n,i;return a(e,[{key:"init",value:(i=t(regeneratorRuntime.mark((function e(){var r,n,t,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.web3.eth.getAccounts();case 2:r=e.sent,n=0;case 4:if(!(n<this._numOracles)){e.next=16;break}return t=r[9+n],o=!1,n<=this._numOracles*this._airlineStatusCodePropability&&(o=!0),e.t0=this._oracles,e.next=11,this.createOracle(t,o);case 11:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 13:n++,e.next=4;break;case 16:return e.abrupt("return",!0);case 17:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"createOracle",value:(n=t(regeneratorRuntime.mark((function e(r,n){var t,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._contract.registerOracle({from:r,value:this.web3.utils.toWei("1","ether")});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("Failed to register oracle ".concat(e.t0.message));case 8:return e.next=10,this._contract.getMyIndexes({from:r});case 10:return t=e.sent,o=t.map((function(e){return e.toNumber()})),e.abrupt("return",new s(r,o,n));case 13:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(e,r){return n.apply(this,arguments)})},{key:"getFlightStatus",value:(r=t(regeneratorRuntime.mark((function e(r){var n,t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n={}).index=r.index,n.airline=r.airline,n.flight=r.flight,n.timestamp=r.timestamp,t=[],this._oracles.forEach((function(e){var n=e.getFlightStatus(r);n&&t.push(n)})),e.abrupt("return",t);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})}]),e}();var s=function(){function e(r,n,t){o(this,e),this._address=r,this._indexes=n,this._isAlwaysAirlineStatusCode=t}return a(e,[{key:"getFlightStatus",value:function(e){if(this.findIndex(parseInt(e.index),this._indexes)){if(this._isAlwaysAirlineStatusCode)return this.createResponse(e,{code:20,address:this._address});var r=Math.ceil(1e6*Math.random());return this.createResponse(e,{code:r%6*10,address:this._address})}}},{key:"findIndex",value:function(e,r){return r.find((function(r){return r===e}))}},{key:"createResponse",value:function(e,r){return{index:e.index,airline:e.airline,flight:e.flight,timestamp:e.timestamp,statusCode:r.code,address:r.address}}}]),e}()},"./src/server/index.js":function(e,r,n){"use strict";n.r(r);var t=n("http"),o=n.n(t),i=n("./src/server/server.js"),a=n.n(i),s=o.a.createServer(a.a),c=a.a;s.listen(3001),e.hot.accept("./src/server/server.js",function(e){i=n("./src/server/server.js"),a=n.n(i),s.removeListener("request",c),s.on("request",a.a),c=a.a}.bind(this))},"./src/server/server.js":function(e,r,n){function t(e,r,n,t,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?r(c):Promise.resolve(c).then(t,o)}function o(e){return function(){var r=this,n=arguments;return new Promise((function(o,i){var a=e.apply(r,n);function s(e){t(a,o,i,s,c,"next",e)}function c(e){t(a,o,i,s,c,"throw",e)}s(void 0)}))}}var i=n("fs"),a=n("web3"),s=n("./src/server/OracleApp.js"),c=n("truffle-contract"),u=(n("express"),JSON.parse(i.readFileSync("../../build/contracts/FlightSuretyApp.json"))),l=JSON.parse(i.readFileSync("./config.json")).localhost,d=new a.providers.WebsocketProvider(l.url.replace("http","ws")),f=c(u);f.setProvider(d),o(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.at(l.appAddress);case 3:return r=e.sent,n=new s({numOracles:20,statusCodes:[0,10,20,30,40,50],airlineStatusCodeProbability:.8},r,new a(d)),e.next=7,n.init();case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:r.OracleRequest().on("data",function(){var e=o(regeneratorRuntime.mark((function e(t){var i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={index:t.returnValues.index,airline:t.returnValues.airline,flight:t.returnValues.flight,timestamp:t.returnValues.timestamp},e.prev=1,e.next=4,n.getFlightStatus(i);case 4:a=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0);case 10:console.log(a),a.forEach(function(){var e=o(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.submitOracleResponse(n.index,n.airline,n.flight,n.timestamp,n.statusCode,{from:n.address,gas:999999999});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(r){return e.apply(this,arguments)}}());case 12:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(r){return e.apply(this,arguments)}}()).on("error",(function(e){console.log(e)}));case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))()},0:function(e,r,n){n("./node_modules/webpack/hot/poll.js?1000"),e.exports=n("./src/server/index.js")},express:function(e,r){e.exports=require("express")},fs:function(e,r){e.exports=require("fs")},http:function(e,r){e.exports=require("http")},"truffle-contract":function(e,r){e.exports=require("truffle-contract")},web3:function(e,r){e.exports=require("web3")}});